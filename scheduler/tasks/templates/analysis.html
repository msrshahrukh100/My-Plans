{% extends "index.html" %}

{% block title %} History | {{ request.user }} {% endblock %}

{% block content %}

<h2 class="center">Analysis</h2>
<div class="row">
	<div class="col s12 m10 l10 offset-l1 offset-m1">
		<canvas id="myChart" width="400" height="400" data-actionurl="{% url 'tasks:get_analysis_data' %}"></canvas>
	</div>
</div>
{% endblock %}

{% block extra_scripts %}

<script type="text/javascript">
var ctx = document.getElementById("myChart").getContext('2d');

var backgroundColor = [];
var borderColor = [];

$.ajax({
	type: 'GET',
	url: $('#myChart').attr('data-actionurl'),
	success: function(data){
		var myChart = new Chart(ctx, {
		    type: 'horizontalBar',
		    data: {
		        labels: data['labels'],
		        datasets: [{
		            label: '% of days Days accomplished',
		            data: data['values'],
		            backgroundColor: data["color"],
		            borderColor: data["border_color"],
		            borderWidth: 1
		        }]
		    },
		    options: {
		        scales: {
		            yAxes: [{
		                ticks: {
		                    beginAtZero:true
		                }
		            }]
		        }
		    },
			plugins: [{
			  beforeDraw: function(c) {
			     var chartHeight = c.chart.height;
			     c.scales['y-axis-0'].options.ticks.fontSize = chartHeight * 1 / 100; //fontSize: 6% of canvas height
			  }
			}]
		});
	}
})

</script>

{% endblock %}

